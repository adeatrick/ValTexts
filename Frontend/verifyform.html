<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
  <script type="text/javascript">
    document.title = "Verify"
    window.addEventListener("load", function (){

      var form = document.getElementById('form_id');
      form.addEventListener('submit', function(event){

        event.preventDefault();

        let phone = form.elements.namedItem("phone").value;
        let code = form.elements.namedItem("code").value;

        let xhr = new XMLHttpRequest();
        xhr.addEventListener('load', function(event) {
          if(xhr.status == 200){ //OKAY
            window.location.href = "https://whatsatval.com";
          }
          else{
            var errorDiv = document.getElementById("errorDiv");
            errorDiv.innerHTML = "";
            let res = JSON.parse(this.responseText);
            if(res.err){
              errorDiv.appendChild(document.createTextNode(xhr.status + ": " + res.err));
            }
            else{
              errorDiv.appendChild(document.createTextNode(xhr.status + ": " + this.responseText));
            }
            errorDiv.style.backgroundColor = "red";
          }
        });

        xhr.open('POST', '../api/verify/' + phone + "/" + code);
        xhr.send();
      });
    });
  </script>
</head>
<body>
  <div class = "row" style="margin:30px;">
    <div class = "col-sm-3">
    </div>
    <div class = "col-sm-6">
      <h3 class = "text-center">Verify your phone</h3>
      <form id = "form_id">
        <div style="margin:30px;">
          <div class="form-group">
            <label for="phone">Phone</label>
            <input type="text" class="form-control" id = "phone" placeholder="Enter phone" required>
            <small id="phoneHelp" class="form-text text-muted">Sorry, I know you just did that. But I need it again. Format: 123-456-7890</small>
          </div>
          <div class="form-group">
            <label for="code">Security Code</label>
            <input type="text" class="form-control" id = "code" placeholder="Enter security code" required>
            <small id="codeHelp" class="form-text text-muted">You should this receive three-digit number by text from the number you entered on the previous page.</small>
          </div>
        <div id = "errorDiv">
        </div>
        <div style="margin:30px;">
          <button type="submit" class="btn btn-primary">Submit</button>
        </div>
      </form>
    </div>
    <div class = "col-sm-3">
    </div>
  </div>
</body>
